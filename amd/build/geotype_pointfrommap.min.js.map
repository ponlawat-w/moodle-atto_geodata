{"version":3,"sources":["../src/geotype_pointfrommap.js"],"names":["define","$","Leaflet","OsmBasemap","_map","_point","_marker","setPoint","point","lat","lng","setLatLng","marker","addLayer","html","removeLayer","init","$body","attr","addClass","appendTo","css","map","setView","on","e","latlng","bind","save","$result","outerHTML","dispose","off","remove"],"mappings":"AAAAA,OAAM,qCAAC,CACL,QADK,CAEL,oBAFK,CAGL,0BAHK,CAAD,CAIH,SACDC,CADC,CAEDC,CAFC,CAGDC,CAHC,QAIG,CACJC,IAAI,CAAE,IADF,CAEJC,MAAM,CAAE,IAFJ,CAGJC,OAAO,CAAE,IAHL,CAIJC,QAAQ,CAAE,kBAASC,CAAT,CAAgB,CACxB,GAAIA,CAAK,EAAIA,CAAK,CAACC,GAAf,EAAsBD,CAAK,CAACE,GAAhC,CAAqC,CACnC,KAAKL,MAAL,CAAcG,CAAd,CACA,GAAI,KAAKF,OAAT,CAAkB,CAChB,KAAKA,OAAL,CAAaK,SAAb,CAAuB,KAAKN,MAA5B,CACD,CAFD,IAEO,CACL,KAAKC,OAAL,CAAeJ,CAAO,CAACU,MAAR,CAAe,KAAKP,MAApB,CAAf,CACA,KAAKD,IAAL,CAAUS,QAAV,CAAmB,KAAKP,OAAxB,CACD,CACDL,CAAC,CAAC,sBAAD,CAAD,CAA0Ba,IAA1B,oBAA2C,KAAKT,MAAL,CAAYI,GAAvD,uBAAwE,KAAKJ,MAAL,CAAYK,GAApF,EACD,CATD,IASO,CACL,KAAKL,MAAL,CAAc,IAAd,CACA,GAAI,KAAKC,OAAT,CAAkB,CAChB,KAAKF,IAAL,CAAUW,WAAV,CAAsB,KAAKT,OAA3B,CACD,CACDL,CAAC,CAAC,sBAAD,CAAD,CAA0Ba,IAA1B,CAA+B,aAA/B,CACD,CACF,CArBG,CAsBJE,IAAI,CAAE,eAAuB,CAC3B,GAAMC,CAAAA,CAAK,CAAGhB,CAAC,CAAC,oBAAD,CAAf,CAEAA,CAAC,CAAC,OAAD,CAAD,CACGiB,IADH,CACQ,IADR,CACc,qBADd,EAEGC,QAFH,CAEY,aAFZ,EAGGL,IAHH,CAGQ,aAHR,EAIGM,QAJH,CAIYH,CAJZ,EAMAhB,CAAC,CAAC,OAAD,CAAD,CACGiB,IADH,CACQ,IADR,CACc,kBADd,EAEGG,GAFH,CAEO,OAFP,CAEgB,MAFhB,EAGGA,GAHH,CAGO,QAHP,CAGiB,MAHjB,EAIGD,QAJH,CAIYH,CAJZ,EAME,KAAKb,IAAL,CAAYF,CAAO,CAACoB,GAAR,CAAY,kBAAZ,CAAZ,CACA,KAAKlB,IAAL,CAAUS,QAAV,CAAmBV,CAAnB,EACA,KAAKC,IAAL,CAAUmB,OAAV,CAAkB,CAAC,CAAD,CAAI,CAAJ,CAAlB,CAA0B,CAA1B,EACA,KAAKnB,IAAL,CAAUoB,EAAV,CAAa,OAAb,CAAsB,SAASC,CAAT,CAAY,CAChC,KAAKlB,QAAL,CAAckB,CAAC,CAACC,MAAhB,CACD,CAFqB,CAEpBC,IAFoB,CAEf,IAFe,CAAtB,EAGA1B,CAAC,CAAC,mBAAD,CAAD,CAAuBkB,QAAvB,CAAgC,mBAAhC,CACH,CA5CG,CA6CJS,IAAI,CAAE,eAAW,CACf,GAAI,KAAKvB,MAAL,EAAe,KAAKA,MAAL,CAAYI,GAA3B,EAAkC,KAAKJ,MAAL,CAAYK,GAAlD,CAAuD,CACrD,GAAMmB,CAAAA,CAAO,CAAG5B,CAAC,CAAC,QAAD,CAAD,CACbkB,QADa,CACJ,qCADI,EAEbL,IAFa,WAEL,KAAKT,MAAL,CAAYI,GAFP,aAEc,KAAKJ,MAAL,CAAYK,GAF1B,EAAhB,CAGA,MAAOmB,CAAAA,CAAO,CAAC,CAAD,CAAP,CAAWC,SACnB,CACD,QACD,CArDG,CAsDJC,OAAO,CAAE,kBAAW,CAClB,GAAI,KAAK3B,IAAT,CAAe,CACb,KAAKA,IAAL,CAAU4B,GAAV,GACA,KAAK5B,IAAL,CAAU6B,MAAV,GACA,KAAK7B,IAAL,CAAY,IACb,CACF,CA5DG,CAJH,CAJG,CAAN","sourcesContent":["define([\n  'jquery',\n  'local_leaflet/core',\n  'local_leaflet/osmbasemap'\n], (\n  $,\n  Leaflet,\n  OsmBasemap\n) => ({\n  _map: null,\n  _point: null,\n  _marker: null,\n  setPoint: function(point) {\n    if (point && point.lat && point.lng) {\n      this._point = point;\n      if (this._marker) {\n        this._marker.setLatLng(this._point);\n      } else {\n        this._marker = Leaflet.marker(this._point);\n        this._map.addLayer(this._marker);\n      }\n      $('#atto_geodata-latlng').html(`[[LAT]]: ${this._point.lat}, [[LNG]]: ${this._point.lng}`);\n    } else {\n      this._point = null;\n      if (this._marker) {\n        this._map.removeLayer(this._marker);\n      }\n      $('#atto_geodata-latlng').html('[[NOPOINT]]');\n    }\n  },\n  init: function(defaultValue) {\n    const $body = $('#atto_geodata-body');\n\n    $('<div>')\n      .attr('id', 'atto_geodata-latlng')\n      .addClass('text-center')\n      .html('[[NOPOINT]]')\n      .appendTo($body);\n\n    $('<div>')\n      .attr('id', 'atto_geodata-map')\n      .css('width', '100%')\n      .css('height', '50vh')\n      .appendTo($body);\n      \n      this._map = Leaflet.map('atto_geodata-map');\n      this._map.addLayer(OsmBasemap);\n      this._map.setView([0, 0], 1);\n      this._map.on('click', function(e) {\n        this.setPoint(e.latlng);\n      }.bind(this));\n      $('#atto_geodata-map').addClass('leaflet-crosshair');\n  },\n  save: function() {\n    if (this._point && this._point.lat && this._point.lng) {\n      const $result = $('<span>')\n        .addClass('filter-geodata filter-geodata-point')\n        .html(`${this._point.lat},${this._point.lng}`);\n      return $result[0].outerHTML;\n    }\n    return false;\n  },\n  dispose: function() {\n    if (this._map) {\n      this._map.off();\n      this._map.remove();\n      this._map = null;\n    }\n  }\n}));\n"],"file":"geotype_pointfrommap.min.js"}